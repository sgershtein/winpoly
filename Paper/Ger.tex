\documentstyle{article}
\author{С.Я.Герштейн}
\title{LaTeX}
\frenchspacing
\begin{document}

\begin{thebibliography}
\bibitem{va}К.~Вейлер, П.~Азертон. Книга.
\bibitem{vtu}В.А.~Вахрушев, А.М.~Тарасьев, В.Н.~Ушаков. Статья.
\end{thebibliography}
\title{Алгоритмы и представление данных для решения задач на ЭВМ}

Приближенное вычисление множеств позиционного поглощения в задачах на плоскости
$R^2$ может быть осуществлено на ЭВМ при помощи алгоритмов, основой которых
являются процедуры пересечения и объединения невыпуклых ограниченных многоугольников
с внутренними отверстиями.

Вопросы объединения и пересечения невыпуклых многоугольников на плоскости уже
рассматривались в работах К.~Вейлера и П.~Азертона \cite{va}, а также В.А.~Вахрушева,
А.М.~Тарасьева и В.Н.~Ушакова \cite{vtu}. Алгоритм Вейлера-Азертона позволяет
производить отсечение невыпуклого многоугольника с внутренними отверстиями по
другому невыпуклому многоугольнику, также имеющему внутренние отверстия. В
работе Вахрушева, Тарасьева и Ушакова приводятся алгоритмы объединения и
пересечения многоугольников с внутренними отверстиями на плоскости.

Основным отличием рассматриваемого алгоритма от алгоритмов, приводимых в работе
[:] является в первую очередь отсутствие необходимости рассмотрения в ходе
вычислений большого числа частных случаев и вариантов попарного пересечения
граней различных контуров многоугольников. В результате этого, приводимый
алгоритм является более простым для понимания, реализации на языке
программирования и для отладки.

\section{Представление данных}

Для приближенного представления в памяти ЭВМ некоторого компактного множества
удобно ввести несколько определений.

{\bf Определение 1.} Множества $G_1$ и $G_2$ назовем {\it почти
непересекающимися}, если их пересечение $G_1\cap G_2$ состоит из не более
чем конечного числа точек.

{\bf Определение 2.} {\it Обобщенным многоугольником} назовем множество
$T=cl(T_0\setminus(\bigcup_{i=1}^{k}\widetilde{T}_i))$, где $T_0$, $T_i$
$(i=1\dots k)$ -- непустые многоугольники на плоскости $R^2$ с конечным числом
вершин, причем $\widetilde{T}_i\subset T_0 (i=1\dots k)$. При этом многоугольники
${T_i,T_j}_{i\ne j}$ почти не пересекаются.

В памяти компьютера обобщенный многоугольник представляется в виде
последовательности пар координат вершин внешнего контура, перечисленных в
положительном порядке обхода контура (против часовой стрелки) и совокупности
координат вершин контуров внутренних многоугольных отверстий. Вершины
внутренних контуров обобщенного многоугольника перечисляются в отрицательном
направлении обхода (по часовой стрелке). Таким образом, при движении как по
внешнему, так и по внутренним контурам многоугольника в порядке перечисления
вершин этих контуров, внутренность многоугольника остается слева от границы.
Для хранения информации об обобщенном многоугольнике необходимо $O(N)$ ячеек
памяти, где $N$ -- суммарное количество вершин обобщенного многоугольника, в
том числе вершин внутренних отверстий.

Рассматриваемые в задачах множества на плоскости $R^2$ (в том числе целевое
множество и сечения множества позиционного поглощения в каждый момент времени)
приближенно представляются в памяти ЭВМ в виде совокупности конечного числа
обобщенных многоугольников, попарные пересечения которых содержат не более чем
конечное число точек.

{\bf Определение 3.} {\it Игровым полем} назовем совокупность не более чем
конечного числа попарно почти не пересекающихся обобщенных многоугольников на
плоскости $R^2$.

Необходимо отметить, что игровое поле не может служить приближением множеств
нулевой площади на плоскости $R^2$, например ломаной, отрезка или точки.
Однако, в рассматриваемых задачах все интересующие нас множества не содержат
существенных подмножеств нулевой площади, что позволяет использовать введенное
определение игрового поля для приближенного представления данных в ЭВМ.

\section{Алгоритмы объединения и пересечения обобщенных многоугольников}

Алгоритмы построения объединения и пересечения двух обобщенных многоугольников
являются основой процесса вычисления множеств позиционного поглощения в
рассматриваемых задачах. Алгоритмы объединения и пересечения являются в целом
идентичными, с точностью до изменения на противоположные некоторых логических
условий. Ниже полностью приводится алгоритм пересечения обобщенных
многоугольников, а также описываются его отличия от алгоритма объединения.
Приводимые алгоритмы обладают временной сложностью $O(N^2)$, где $N$ -
суммарное число вершин обоих обобщенных многоугольников, участвующих в операции.

Входными данными для алгоритма пересечения являются два обобщенных
многоугольника $P_1$ и $P_2$. В результате работы алгоритма получается игровое
поле, представляющее собой результат пересечения $P_1$ и $P_2$ с точностью до
множеств нулевой площади.

Некоторые операции, использующиеся в приводимом алгоритме, например определение
принадлежности точки внутренности многоугольника, заданного координатами вершин,
являются хорошо известными, и описаны, в частности в [:].

{\bf Алгоритм 1.} Пересечение двух обобщенных многоугольников.

\begin{enumerate}
\item Обнаружение всех точек пересечения граней $P_1$ и $P_2$.
	\begin{enumerate}
	\item Для каждой пары отрезков $(p_{1,k_1}, p_{2,k_2})$, где $p{j,k_j}$ --
	отрезок внешнего или одного из внутренних контуров обобщенного
    многоугольника $P_j$, проверяем, пересекаются ли они. Точки пересечения,
    являющиеся внутренними точками граней, добавляем в соответствующие контуры
    в качестве дополнительных вершин.
	\item Для каждой обнаруженной точки пересечения устанавливаем многосторонние
    связи между всеми вершинами различных контуров, совпадающими с этой точкой.
	\item Для каждой вершины, являющейся точкой пересечения, вычисляем полярный
    угол вектора подхода к данной вершине вдоль грани при движении по контуру
    в заданном для этого контура направлении обхода.
	\end{enumerate}
\item Построение набора новых замкнутых контуров.
	\begin{enumerate}
	\item Инициализируем два списка новых контуров (изначально пустые). В один
    список будут заноситься контуры положительной ориентации (порядок обхода
    вершин - против часовой стрелки), в другой - контуры отрицательной
    ориентации (порядок обхода вершин - по часовой стрелке). Изначально считаем
    все вершины всех контуров непомеченными.
	\item \label{nomark} Если ни одной непомеченной вершины не осталось, переходим к п.~\ref{extract}.
    Начиная с любой непомеченной вершины, движемся вдоль контура по направлению
    его обхода, помечая все проходимые вершины. При этом, попав в вершину,
    являющуюся точкой пересечения, дальнейшее направление движения выбираем из
    условия максимального изменения направления вектора движения в сторону
    увеличения полярного угла (влево).
	\item При возникновении цикла (попадании в одну из уже пройденных на данном
    шаге  вершин), полученный замкнутый контур заносим в один из двух списков
    новых контуров, в зависимости от его ориентации (положительной или
    отрицательной), затем переходим к п.~\ref{nomark}. Определение ориентации контура
    основывается на том факте, что при движении вдоль замкнутого
    несамопересекающегося контура положительной ориентации, суммарное изменение
    вектора направления составляет $2\pi$. В случае отрицательной ориентации
    контура, суммарное изменение вектора направления составляет  $-2\pi$.
	\item В случае невозможности продолжения движения (очередная вершина вдоль
    контура уже была помечена на одном из предыдущих шагов) переходим к п.~\ref{nomark}.
	\end{enumerate}
\item \label{extract}Выделение из полученного набора контуров, принадлежащих пересечению $P_1$
и $P_2$.
	\begin{enumerate}
	\item \label{pos_k} Исключаем из рассмотрения все новые контуры положительной ориентации,
    не лежащие внутри обоих обобщенных многоугольников $P_1$ и $P_2$. Контур
    $D$ лежит внутри многоугольника $P_i$, если ни одна из точек -- середин
    граней $D$ не лежит снаружи внешнего контура или внутри одного из внутренних
    контуров $P_i$.
	\item \label{neg_k} Последовательно исключаем из списка отрицательной ориентации все
    контуры $E$, для которых в этом списке найдутся такие контуры
    $\widetilde E$, что $E\subseteq \widetilde E$.
	\end{enumerate}
\item Распределение контуров отрицательной ориентации среди контуров
положительной ориентации
	\begin{enumerate}
    \item Для каждого контура из списка отрицательной ориентации выбираем
    содержащий его контур положительной ориентации. Отрицательные контуры, не
    содержащиеся ни в одном из положительных контуров, исключаем из
    рассмотрения.
    \item Каждый из контуров положительной ориентации в совокупности с
    содержащимися в нем контурами отрицательной ориентации представляет собой
    обобщенный многоугольник. Совокупность полученных обобщенных
    многоугольников образует игровое поле, являющееся результатом пересечения
    исходных обобщенных многоугольников $P_1$ и $P_2$.
    \end{enumerate}

\end{enumerate}

Для получения алгоритма объединения двух обобщенных многоугольников в алгоритм
1 необходимо внести следующие изменения (изменения выделены {\it курсивом}):

\begin{enumerate}

\item В пункте \ref{nomark} условие выбора дальнейшего направления движения следует
заменить условием максимального изменения направления вектора движения в
сторону {\it уменьшения} полярного угла ({\it вправо}).

\item В пункте \ref{pos_k} исключаем из рассмотрения все {\it отрицательные} контуры,
не лежащие внутри обоих исходных многоугольников $P_1$ и $P_2$.

\item В пункте \ref{neg_k} исключаем из списка {\it положительной} ориентации все
контуры $E$, для которых в этом списке найдутся такие контуры $\widetilde E$,
что $E\subseteq \widetilde E$.

\end{enumerate}

\section{Алгоритмы объединения и пересечения\\ двух игровых полей}

Алгоритмы построения объединения и пересечения двух игровых полей основаны на
последовательном применении алгоритмов объединения и пересечения обобщенных
многоугольников.

Входными данными для приводимых алгоритмов являются два игровых поля $F_1$ и
$F_2$. Результатом работы алгоритмов является игровое поле, содержащее
пересечение (объединение) двух исходных игровых полей.

Вычислительная сложность рассматриваемых алгоритмов с учетом вычислительной
сложности алгоритма пересечения (объединения) двух обобщенных многоугольников
составляет не более $O(k^2N^2)$, где $k$ -- максимальное количество обобщенных
многоугольников на каждом из полей $F_1$ и $F_2$, $N$ -- максимальное
количество вершин в каждом из обобщенных многоугольников. Это значение можно
записать как $O(K^2)$, где $K$ -- суммарное количество вершин контуров всех
обобщенных многоугольников, участвующих в рассмотрении.

{\bf Алгоритм 2.1.} Пересечение двух игровых полей.

\begin{enumerate}
\item \label{p_f} Для каждой пары обобщенных многоугольников $P_i\subset F_1$ и
$Q_j\subset F_2$ строим пересечение $P_i\cap Q_j$
\item Совокупность всех обобщенных многоугольников, являющихся результатами
пересечений в п.~\ref{p_f}, образует результирующее игровое поле.
\end{enumerate}

{\bf Алгоритм 2.2.} Объединение двух игровых полей.

\begin{enumerate}
\item Строим два списка $S_1$ и $S_2$ обобщенных многоугольников, принадлежащих
игровым полям $F_1$ и $F_2$ соответственно.
\item \label{any_pol} Если список $S_1$ пуст, то переходим к п.~\ref{res}. Выбираем любой
многоугольник $P\subset S_1$ и удаляем его из списка $S_1$. Инициализируем
изначально пустой список $\widetilde S_2$.
\item Повторяем шаги \ref{circ1}-\ref{circ2} для каждого из многоугольников $Q_i\subset S_2$.
	\begin{enumerate}
%    \renewcommand{theenumii}{\arabic{enumii}}
	\item \label{circ1} Cтроим объединение $P\cup Q_i$. В случае, если обобщенные многоугольники
    $P$ и $Q_i$ пересекаются, их объединение будет состоять из одного
    обобщенного многоугольника $D$. В противном случае игровое поле, являющееся
    объединением $P$ и $Q_i$ будет состоять непосредственно из двух этих
    обобщенных многоугольников.
	\item \label{circ2} Если результат объединения $P\cup Q_i$ состоит из одного многоугольника
    $D$, в дальнейшем в качестве текущего многоугольника $P$ рассматриваем
    обобщенный многоугольник $D$. В противном случае добавляем многоугольник
    $Q_i$ в список $\widetilde S_2$.
	\end{enumerate}
\item Добавляем обобщенный многоугольник $P$ к списку $\widetilde S_2$ и заменяем
список $S_2$ на список $\widetilde S_2$. Переходим к п.~\ref{any_pol}.
\item \label{res} Совокупность всех обобщенных многоугольников, содержащихся в
списке $S_2$, образует результирующее игровое поле.
\end{enumerate}

\section{Операция просеивания}

Одной из существенных операций в процессе приближенного построения множеств
позиционного поглощения для рассматриваемых задач является операция просеивания.
Необходимость этой операции обусловлена тем, что после каждого шага попятной
процедуры очередной построенный элемент аппроксимирующей системы множеств
$W(t_i)$ может быть представлен в виде игрового поля, состоящего из все
большего числа вершин. Такое увеличение числа вершин не дает повышения точности
вычислений, т.к. эта точность ограничена снизу погрешностью, зависящей в
частности от величины шага по времени $\Delta$. В то же время, увеличение
количества вершин в рассматриваемых игровых полях приводит к существенному
увеличению времени расчетов. Так например, в случае геометрического роста
количества вершин игрового поля на каждом шаге попятной процедуры, итоговая
вычислительная сложность общего алгоритма становится экспоненциальной.

С целью сохранения квадратичной вычислительной сложности алгоритма
приближенного построения множества позиционного поглощения, в него вводится
процедура просеивания, позволяющая исключить из рассмотрения несущественные
вершины игровых полей.

Приводимый ниже алгоритм  реализует операцию просеивания. Входными данными
алгоритма является игровое поле $F$. Результатом работы алгоритма является
исключение из $F$ несущественных вершин. В алгоритме используются параметры:
положительные константы диаметра просеивания $\delta_1$ и $\delta_2$.

Вычислительная сложность алгоритма составляет $O(K)$, где $K$ -- общее
количество вершин игрового поля $F$.

{\bf Алгоритм 3.} Операция просеивания.

\begin{enumerate}
\item Повторяем пп. \ref{rep1.1}-\ref{rep1.2} для каждого из обобщенных многоугольников $P_i\in F$.
	\begin{enumerate}
%    \renewcommand{theenumii}{\arabic{enumii}}
	\item \label{rep1.1} Повторяем пп. \ref{rep2.1}-\ref{rep2.2} для внешнего контура $P^*_i$, а также для
    каждого из внутренних контуров $P^j_i$ обобщенного многоугольника $P_i$.
    	\begin{enumerate}
%        \renewcommand{theenumiii}{\arabic{enumiii}}
		\item \label{rep2.1} Если для некоторой тройки последовательных вершин рассматриваемого
        контура $p_{i-1}, p_i, p_{i+1}$ расстояние $|p_i-p_{i-1}|<\delta_1$
        или $|p_i-p_{i+1}|<\delta_1$, то исключаем вершину $p_i$ из
        рассматриваемого контура.
        \item \label{rep2.2} Если для некоторой тройки последовательных вершин рассматриваемого
        контура $p_{i-1}, p_i, p_{i+1}$ длина высоты $h$, опущенной из вершины
        $p_i$ на ребро $p_{i-1}p_{i+1}$, менее $\delta_2 (|h|<\delta_2)$, то
        исключаем вершину $p_i$ из рассматриваемого контура.
	\end{enumerate}
    \item \label{rep1.2} Если в рассматриваемом контуре осталось менее трех вершин, исключаем
    этот контур из рассмотрения. В случае, если исключаемый контур является
    внешним контуром, в котором содержатся собственные внутренние контуры, эти
    внутренние контуры также исключаем из рассмотрения.
    \end{enumerate}

\end{enumerate}

\section{Алгоритм приближенного построения\\ множества позиционного поглощения}

Множество позиционного поглощения для каждой из рассматриваемых задач строится
приближенно методом попятного движения от момента времени $\theta$ к моменту
времени $t_0$. Построение аппроксимирующей системы множеств основывается на
последовательном применении формулы (2.1), где все рассматриваемые множества
представлены в виде игровых полей, а операции объединения и пересечения
множеств реализуются согласно описанным выше алгоритмам.

Приведем формальную запись алгоритма построения аппроксимирующей системы
множеств. В алгоритме используются следующие параметры: $M$ - игровое поле,
задающее приближение целевого множества задачи; $u_{\gamma} (\gamma =1,\dots,k)$
-- некоторое разбиение границы множества возможных векторов управления первого
игрока $P\subset R^2$; $v_{\omega} (w=1,\dots,n)$ -- некоторое разбиение границы
множества возможных векторов управления второго игрока $Q\subset R^2$; $\Delta$
-- шаг по времени между последовательными элементами аппроксимирующей системы
множеств; $\theta$ -- целевое время задачи.

Результатом работы алгоритма является построение аппроксимирующей системы
множеств $\widetilde W(t_i)$, сходящейся при $\Delta\to 0$ к множеству
позиционного поглощения $W^0$ [:].

Алгоритм обладает собственной вычислительной сложностью $O(\gamma\omega)$.
Общая вычислительная сложность алгоритма с учетом вычислительной сложности
используемых процедур составляет $O(\gamma\omega K^2)$, где $K$ -- максимальное
количество вершин в участвующих в алгоритме игровых полях.

{\bf Алгоритм 4.} Построение аппроксимирующей системы множеств
$\widetilde W(t_i)$ методом попятного движения.

\begin{enumerate}
\item Задаем последний элемент аппроксимирующей системы множеств:
$\widetilde W(\theta)=M$. Устанавливаем значение текущего времени
$t=\theta-\Delta$.
\item \label{return} Совершаем попятную процедуру:
	\begin{enumerate}
%    \renewcommand{theenumii}{\arabic{enumii}}
	\item Инициализируем игровое поле $W_v$. Устанавливаем для $W_v$ пометку о
    том, что оно не содержит данных.
	\item Для каждого из значений $v_{\omega} (\omega=1,\dots,n)$ повторяем шаги
    \ref{rep3.1}-\ref{rep3.2}.
		\begin{enumerate}
%            \renewcommand{theenumiii}{\arabic{enumiii}}
			\item \label{rep3.1} Инициализируем изначально пустое игровое поле $W_u$.
			\item Для каждого из значений $u_{\gamma} (\gamma=1,\dots,k)$ повторяем
        шаги \ref{rep4.1}-\ref{rep4.2}.
        		\begin{enumerate}
%                \renewcommand{theenumiv}{\arabic{enumiv}}
				\item \label{rep4.1} Строим
            $X^*=\widetilde X_{\omega,\gamma}(t,t+\Delta,\widetilde W(t+\Delta))$.
            Вершины игрового поля $X^*$ вычисляются по вершинам
            $\widetilde W(t+\Delta)$ на основании исходного уравнения системы
            (1.1). Для этого может быть в частности использован метод Эйлера:
            $x(t)=x(t+\Delta)-\Delta\cdot F(t+\Delta, x(t+\Delta), u_{\gamma}, v_{\omega})$.
            Здесь символом $F(t,x,u,v)$ обозначена правая часть
            дифференциального уравнения (1.1).
				\item \label{rep4.2} Строим объединение игровых полей $X^*\cup W_u$ и присваиваем
            полученный результат в $W_u$.
			\end{enumerate}
		\item \label{rep3.2} В случае, если для игрового поля $W_v$ установлена пометка о том,
        что оно не содержит данных, снимаем эту пометку и присваиваем $W_v$
        значение $W_u$. В противном случае строим пересечение игровых полей
        $W_u\cap W_v$ и присваиваем полученный результат в $W_v$.
		\end{enumerate}
	\item В случае, если рассматривается второй вариант постановки задачи
    (задача к моменту времени), строим объединение множеств $W_v\cap M$) и
    присваиваем полученный результат в $W_v$.
	\item Применяем к игровому полю $W_v$ операцию просеивания.
	\item Полученное игровое поле $W_v$ является элементом аппроксимирующей
    системы множеств. Присваиваем $\widetilde W(t)=W_v$.
	\end{enumerate}
\item Если $t\ge \Delta$, то уменьшаем значение $t$ на величину $\Delta$ и
переходим к п.~\ref{return}.
\item Построение аппроксимирующей системы множеств $W(t_i)$ закончено.
\end{enumerate}

\section{Примеры}

Описанные выше алгоритмы использовались для приближенного вычисления множеств
позиционного поглощения в двух модельных задачах. Ниже приводятся постановки
этих задач, а также результаты приближенного построения множеств позиционного
поглощения для этих задач.

\subsection{Постановки задач}

1. Задача "Шофер-убийца"

Рассматривается конфликтно-управляемая система на плоскости $R^2$, которая на
промежутке времени $[0;36]$ описывается системой дифференциальных уравнений
$$
\left\{
\begin{array}{rcl}
\dot x&=&\frac{-w_1yu_1}{r}+w_2v_1\\
\dot y&=&\frac{w_1xu_1}{r}+w_2v_2-w_1
\end{array}
\right.
$$
Для первого игрока решается второй вариант задачи о сближении с целью $M$, т.е.
задача о сближении к моменту времени $\theta=36$.

Управляющее воздействие первого игрока $u_1$ выбирается из условия
$u\in[-1;1]$. Вектор управляющего воздействие второго игрока $(v_1,v_2)$
выбирается из множества $Q$, представляющего собой круг с центром в начале
координат единичного радиуса.

В системе уравнений используются следующие значение параметров:
$r=4; w_1=2; w_2=1$.

Задача построения множества позиционного поглощения решалась для следующих
вариантов задания целевого множества $M$:

\begin{enumerate}
\begin{enumerate}
\item Целевое множество $M$ представляет собой круг радиуса 1.5 с центром в
начале координат.
\item Целевое множество $M$ представляет собой несвязное множество, состоящее
из двух квадратов с длиной стороны 1.5, расположенных симметрично относительно
оси ординат. Координаты вершин квадратов следующие:
$(-2;-0.5)$, $(-0.5;-0.5)$, $(-0.5;1)$, $(-2;1)$ и $(2;-0.5)$, $(2;1)$, 
$(0.5;1)$, $(0.5;-0.5)$.
\end{enumerate}
\end{enumerate}

Задача решалась с использованием параметров шага по времени $\Delta=0.02$ и
диаметров просеивания $\delta_1=\delta_2=0.005$.

2.	Задача Вайндлиха

Рассматривается конфликтно-управляемая система на плоскости $R^2$, которая на
промежутке времени $[0;0.8]$ описывается системой дифференциальных уравнений.
$$
\left\{
\begin{array}{rcl}
\dot x&=&x(au-x)+v_1\\
\dot y&=&y(bu-y)+v_2
\end{array}
\right.
$$
Управляющие воздействие первого игрока u выбирается из условия $u\in[-1;1]$.
Вектор управляющего воздействие второго игрока $(v_1,v_2)$ выбирается из
множества $Q$, представляющего собой отрезок на плоскости, соединяющий точки
$(-1;-1)$ и $(1;1)$.

Целевое множество $M$ представляет собой круг единичного радиуса с центром в
начале координат.

Задача построения множества позиционного поглощения решалась для следующих
вариантов значений параметров $a$ и $b$:

\begin{enumerate}
\begin{enumerate}
\item $a=0.2; b=1.2$
\item $a=0.9; b=0.9$
\end{enumerate}
\end{enumerate}

Задача решалась с использованием параметров шага по времени $\Delta=0.005$ и
диаметров просеивания $\delta_1=\delta_2=0.005$.


\end{document}
 